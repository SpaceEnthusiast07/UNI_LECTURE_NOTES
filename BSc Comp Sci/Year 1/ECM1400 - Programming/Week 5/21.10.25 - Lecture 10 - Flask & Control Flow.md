[Slides](https://ele.exeter.ac.uk/pluginfile.php/5248956/mod_resource/content/2/Program%20Structure%20and%20Flow.pdf)


##### Contents
 - [[#Control Flow]]
 - [[#Scheduling Jobs]]
 - [[#Scheduling Jobs]]
 - [[#Threading]]
 - [[#Asynchronous, Event-Driven Design]]
 - [[#Flask]]
 - [[#How Flask Works]]
 - [[#Using Flask]]
	 - [[#Decorators]]
	 - [[#Multiple Routes]]
	 - [[#Variables in the URL]]
	 - [[#Webpage Templates]]


##### Control Flow
 - ***Sequence***
	 - Statements are *executed in the order* that they are *stated*
	 - Predetermined execution, *doesn't adapt* to anything
 - ***Multi-Threaded Execution***
	 - More *complex* that sequence
	 - Contains *more than one* thread performing a *independent task*
	 - Threads *can interact* with each other ![[Pasted image 20251021104931.png]]
 - ***Asynchronous Execution***
	 - Tasks don't have to happen in the order they were started
	 - Uses *job queues* to schedule work efficiently
	 - Useful in automation and web systems where tasks my start and finish at different times


##### Scheduling Jobs
 - Sometimes you want tasks to happen at specific times or in a particular order
 - You schedule jobs to happen later using: `enter(<delay>, <priority>, <function>, <args>)`
 - Jobs with shorter delay or higher priority run first
```python
import sched, time

s = sched.scheduler(time.time, time.sleep)

def print_job_name(name):
    print(name)

s.enter(3, 1, print_job_name, ("Job 1",))
s.enter(1, 2, print_job_name, ("Job 2",))
s.enter(1, 1, print_job_name, ("Job 3",))
s.run()

--OUTPUT-------------------------------------------------------------
Job 3
Job 2
Job 1
```


##### Threading
 - Allow tasks to be executed *simultaneously*
 - Can make programs run *faster*
 - *Increases complexity* with debugging and maintaining the program
 - Can cause ***race conditions*** where two or more threads try to change the *same thing*
```python
import threading, time, random

def printSomething(text):
	time.sleep(random.randint(0, 3))
	print(text)

x = threading.Thread(target=printSomething, args=("Print",))
y = threading.Thread(target=printSomething, args=("this",))
z = threading.Thread(target=printSomething, args=("now",))

x.start()
y.start()
z.start()
```


##### Asynchronous, Event-Driven Design
 - This design reacts to events, not a fixed order of steps
 - Examples: a video game or web app - they wait for *your actions* (clicks, keypresses, etc) and responds accordingly
 - Features:
	 - Runs *continuously* until terminated
	 - Execution depends on *external signals*, such as mouse clicks or network requests
	 - The *same inputs* can produce *different outputs* because the timing or order may differ
	 - Jobs can run *out of order* depending on when events arrive


##### Flask
 - ***Flask*** is a *Python Web Framework* - a set of tools that make it easy to build and run web applications
 - If you wanted to make a website from scratch in Python, you would have to:
	 - Handle HTTP requests manually
	 - Parse headers and form data
	 - Manage sockets, ports and routing
 - Flask takes care of all of this and lets you focus on the logic - what happens when someone visits a webpage, submits a form, etc.
 - Essentially Flask is the bridge between the website and the python program.


##### How Flask Works
 - When you run a Flask app, Flask starts a *local web server* on your computer (usually on `http://127.0.0.1:5000`)
 - When someone visits that address, Flask:
	 - Receives the request
	 - Looks at the route (the part after `/`)
	 - Runs the Python function you've linked to that route
	 - Return whatever that function returns (e.g. HTML text, JSON data, etc...)
```python
# Import the Flask class from the flask module
from flask import Flask

# Create a Flask app with this file as the main entry point
app = Flask(__name__)

# Decorator that tells Flask to run this func when '/' is visited
@app.route('/')
def home():
	return "Hello World!"

if __name__ == "__main__":
	app.run()
```
 - Functions: e.g. `def HomePage():`
	 - Whatever a function returns becomes the page content that the browser renders
	 - You can either return plain text or HTML code
	 - Example: `return "<h1>Welcome!</h1><p>This is a Flask app.</p>`
	 - `<h1></h1>` - tags declaring a header string element
	 - `<p></p>` - tags declaring a paragraph string element
 - `if __name__ == "__main__":`
	 - Means: "Only run this part of the program is this file is being run directly, not if it's being imported as a module"
	 - Why?: It prevents Flask from auto running is you import this file into another program
 - `app.run()`:
	 - This statement starts the *local web server*


##### Using Flask
###### Decorators
 - They are special python features that allow you to attach *extra behaviour* to a function
 - Example:
```python
# Import the Flask class from the flask module
from flask import Flask

# Create a Flask app with this file as the main entry point
app = Flask(__name__)

# Decorator that tells Flask to run this func when '/' is visited
@app.route('/')
def home():
	return "Hello World!"

if __name__ == "__main__":
	app.run()
```
 - `@app.route('/')` - This is a function decorator that tells Flask to run this function when someone visits the `/` URL
	 - `/` $\rightarrow$ *homepage* or root webpage (like `http://127.0.0.1:5000`)
	 - `/about` $\rightarrow$ about page
	 - `/hello` $\rightarrow$ hello page, etc.

###### Multiple Routes
```python
from flask import Flask

app = Flask(__name__)

@app.route("/")
def HomePage():
	return "This is the Home Page"

@app.route("/about")
def AboutPage():
	return "This is the About Page"

if __name__ == "__main__":
	app.run()
```
 - To access the `HomePage`, use the URL: `http://127.0.0.1:5000` 
 - To access the `AboutPage`, use the URL: `http://127.0.0.1:5000/about` 

###### Variables in the URL
 - Flask supports adding custom strings onto the end of the URL
 - Decorator syntax: `@app.route("/hello/<variable>)`
 - Example:
```python
from flask import Flask

app = Flask("__name__")

@app.route("/home/<name>")
def HomePage(name):
	return f"<h1>Hello, {name}!</h1>"
```
 - Then, visiting `http://127.0.0.1:5000/home/Cameron` will result in a webpage with a `h1` heading of *Hello, Cameron!*
 - The `<name>` part becomes a *function argument*

###### Webpage Templates
 - You can store full webpages in a folder called `templates`
 - `home.html` might contain:
```html
<!DOCTYPE html>
<html>
	<body>
		<h1>Welcome to my site!</h1>
		<p>This page is served by Flask.</p>
	</body>
</html>
```
 - Then in the main Python program:
```python
from flask import Flask, render_template
app = Flask("__name__")

@app.route("/")
def HomePage():
	return render_template("home.html")

if __name__ == "__main__":
	app.run()
```
 - Flask will *automatically* search for a folder named `templates` and look for the `home.html` file within


##### Advanced Flask
 - 



